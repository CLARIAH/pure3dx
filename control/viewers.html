<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>control.viewers API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>control.viewers</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CLARIAH/pure3dx/blob/5948f0757efdfdd0b019d9d5582f265e8b31e9f2/src/pure3d/control/viewers.py#L1-L259" class="git-link">Browse git</a>
</summary>
<pre><code class="python">from textwrap import dedent


class Viewers:
    def __init__(self, Settings):
        &#34;&#34;&#34;Knowledge of the installed 3D viewers.

        This class knows which (versions of) viewers are installed,
        and has the methods to invoke them.

        It is instantiated by a singleton object.

        Parameters
        ----------
        Settings: `control.helpers.generic.AttrDict`
            App-wide configuration data obtained from
            `control.config.Config.Settings`.
        &#34;&#34;&#34;
        self.Settings = Settings
        self.viewers = Settings.viewers
        self.viewerDefault = Settings.viewerDefault

    def addAuth(self, Auth):
        &#34;&#34;&#34;Give this object a handle to the Auth object.

        The Viewers and Auth objects need each other, so one of them must
        be given the handle to the other after initialization.
        &#34;&#34;&#34;
        self.Auth = Auth

    def check(self, viewer, version):
        &#34;&#34;&#34;Checks whether a viewer version exists.

        Given a viewer and a version, it is looked up whether the code
        is present.
        If not, reasonable defaults are returned instead.

        Parameters
        ----------
        viewer: string
            The viewer in question.
        version: string
            The version of the viewer in question.

        Returns
        -------
        tuple
            The viewer and version are returned unmodified if that viewer
            version is supported.
            If the viewer is supported, but not the version, the latest
            supported version of that viewer is taken.
            If the viewer is not supported, the default viewer is taken.
        &#34;&#34;&#34;
        viewers = self.viewers
        if viewer not in viewers:
            viewer = self.viewerDefault
        versions = viewers[viewer].versions
        if version not in versions:
            version = versions[-1]
        return (viewer, version)

    def getButtons(
        self, sceneId, actions, isSceneActive, viewerActive, versionActive, actionActive
    ):
        &#34;&#34;&#34;Produces a set of buttons to launch 3D viewers for a scene.

        Parameters
        ----------
        sceneId: ObjectId
            The scene in question.
        actions: iterable of string
            The actions for which we have to create buttons.
            Typically `view` and possibly also `edit`.
        isSceneActive: boolean
            Whether this scene is active, i.e. loaded in a 3D viewer.
        viewerActive: string or None
            The viewer in which the scene is currently loaded,
            if any, otherwise None
        versionActive: string or None
            The version of the viewer in which the scene is currently loaded,
            if any, otherwise None
        actionActive: string or None
            The mode in which the scene is currently loaded in the viewer
            (`view` or `edit`),
            if any, otherwise None

        Returns
        -------
        string
            The HTML that represents the buttons.
        &#34;&#34;&#34;
        viewers = self.viewers

        buttons = []
        frame = &#34;&#34;

        for viewer in viewers:
            isViewerActive = isSceneActive and viewer == viewerActive
            vwActive = &#34;active&#34; if isViewerActive else &#34;&#34;
            buttons.append(
                dedent(
                    f&#34;&#34;&#34;&lt;span class=&#34;vw&#34;&gt;&lt;span class=&#34;vwl {vwActive}&#34;&gt;{viewer}&lt;/span&gt;
                        &lt;span class=&#34;vwv&#34;&gt;
                    &#34;&#34;&#34;
                )
            )

            for version in viewers[viewer].versions:
                isVersionActive = isViewerActive and version == versionActive
                vsActive = &#34;active&#34; if isVersionActive else &#34;&#34;
                buttons.append(
                    f&#34;&#34;&#34;&lt;span class=&#34;vv&#34;&gt;&lt;span class=&#34;vvl {vsActive}&#34;&gt;{version}&lt;/span&gt;&#34;&#34;&#34;
                )
                for action in actions:
                    isActionActive = isVersionActive and action == actionActive
                    btActive = &#34;active&#34; if isActionActive else &#34;&#34;

                    elem = &#34;a&#34;
                    attStr = &#34;&#34;

                    if btActive:
                        frame = dedent(
                            f&#34;&#34;&#34;
                            &lt;div class=&#34;model&#34;&gt;
                                &lt;iframe
                                  class=&#34;previewer&#34;
                                  src=&#34;/viewer/{viewer}/{version}/{action}/{sceneId}&#34;/&gt;
                                &lt;/iframe&gt;
                            &lt;/div&gt;
                            &#34;&#34;&#34;
                        )
                        elem = &#34;span&#34;
                    else:
                        attStr = (
                            f&#39; href=&#34;/scenes/{sceneId}/{viewer}/{version}/{action}&#34; &#39;
                        )

                    cls = f&#34;button {btActive} vwb&#34;
                    begin = f&#34;&#34;&#34;&lt;{elem} class=&#34;{cls}&#34; {attStr}&gt;&#34;&#34;&#34;
                    end = f&#34;&lt;/{elem}&gt;&#34;
                    buttons.append(f&#34;{begin}{action}{end}&#34;)
                buttons.append(&#34;&#34;&#34;&lt;/span&gt; &#34;&#34;&#34;)
            buttons.append(&#34;&#34;&#34;&lt;/span&gt;&lt;/span&gt; &#34;&#34;&#34;)

        return (frame, &#34;\n&#34;.join(buttons))

    def genHtml(self, urlBase, sceneName, viewer, version, action):
        &#34;&#34;&#34;Generates the HTML for the viewer page that is loaded in an iframe.

        When a scene is loaded in a viewer, it happens in an iframe.
        Here we generate the complete HTML for such an iframe.

        Parameters
        ----------
        urlBase: string
            The first part of the root url that is given to the viewer.
            The viewer code uses this to retrieve additional information.
            The root url will be completed with the `action` and the `viewer`.
        sceneName: string
            The name of the scene in the file system. The viewer will find the
            scene json file by this name.
        viewer: string
            The chosen viewer.
        version: string
            The chosen version of the viewer.
        action: string
            The chosen mode in which the viewer is launched (`view` or `edit`).

        Returns
        -------
        string
            The HTML for the iframe.
        &#34;&#34;&#34;
        Settings = self.Settings
        debugMode = Settings.debugMode
        viewerUrlBase = Settings.viewerUrlBase

        ext = &#34;dev&#34; if debugMode else &#34;min&#34;

        viewerStatic = f&#34;{viewerUrlBase}/{viewer}/{version}&#34;
        viewerRoot = self.getRoot(urlBase, action, viewer)

        if viewer == &#34;voyager&#34;:
            element = &#34;explorer&#34; if action == &#34;view&#34; else &#34;story&#34;
            return dedent(
                f&#34;&#34;&#34;
                &lt;head&gt;
                &lt;meta charset=&#34;utf-8&#34;&gt;
                &lt;link
                  href=&#34;{viewerStatic}/fonts/fonts.css&#34;
                  rel=&#34;stylesheet&#34;
                /&gt;
                &lt;link
                  rel=&#34;shortcut icon&#34;
                  type=&#34;image/png&#34;
                  href=&#34;{viewerStatic}/favicon.png&#34;
                /&gt;
                &lt;link
                  rel=&#34;stylesheet&#34;
                  href=&#34;{viewerStatic}/css/voyager-{element}.{ext}.css&#34;
                /&gt;
                &lt;script
                  defer
                  src=&#34;{viewerStatic}/js/voyager-{element}.{ext}.js&#34;&gt;
                &lt;/script&gt;
                &lt;/head&gt;
                &lt;body&gt;
                &lt;voyager-{element}
                  root=&#34;{viewerRoot}&#34;
                  document=&#34;{sceneName}.json&#34;
                  resourceroot=&#34;{viewerStatic}&#34;
                &gt; &lt;/voyager-{element}&gt;
                &lt;/body&gt;
                &#34;&#34;&#34;
            )
        else:
            return dedent(
                f&#34;&#34;&#34;
                &lt;head&gt;
                &lt;meta charset=&#34;utf-8&#34;&gt;
                &lt;/head&gt;
                &lt;body&gt;
                &lt;p&gt;Unsupported viewer: {viewer}&lt;/p&gt;
                &lt;/body&gt;
                &#34;&#34;&#34;
            )

    def getRoot(self, urlBase, action, viewer):
        &#34;&#34;&#34;Composes the root url for a viewer.

        Parameters
        ----------
        urlBase: string
            The first part of the root url, depending
            on the project and edition.
        action: string
            The mode in which the viewer is opened.
            Depending on the mode, the viewer code may communicate with the server
            with different urls.
            For example, for the voyager,
            the `view` mode (voyager-explorer) uses ordinary HTTP requests,
            but the `edit` mode (voyager-story) uses WebDAV requests.

            So this app points voyager-explorer to a root url starting with `/data`,
            and voyager-story to a root url starting with `/webdav`.

            These prefixes of the urls can be configured per viewer
            in the viewer configuration in `yaml/viewers.yml`.
        &#34;&#34;&#34;
        viewers = self.viewers

        if viewer not in viewers:
            return None

        modes = viewers[viewer].modes

        prefix = modes[action] or modes.view

        return f&#34;{prefix}/{urlBase}&#34;</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="control.viewers.Viewers"><code class="flex name class">
<span>class <span class="ident">Viewers</span></span>
<span>(</span><span>Settings)</span>
</code></dt>
<dd>
<div class="desc"><p>Knowledge of the installed 3D viewers.</p>
<p>This class knows which (versions of) viewers are installed,
and has the methods to invoke them.</p>
<p>It is instantiated by a singleton object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>Settings</code></strong> :&ensp;<code><a title="control.helpers.generic.AttrDict" href="helpers/generic.html#control.helpers.generic.AttrDict">AttrDict</a></code></dt>
<dd>App-wide configuration data obtained from
<code><a title="control.config.Config.Settings" href="config.html#control.config.Config.Settings">Config.Settings</a></code>.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CLARIAH/pure3dx/blob/5948f0757efdfdd0b019d9d5582f265e8b31e9f2/src/pure3d/control/viewers.py#L4-L259" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Viewers:
    def __init__(self, Settings):
        &#34;&#34;&#34;Knowledge of the installed 3D viewers.

        This class knows which (versions of) viewers are installed,
        and has the methods to invoke them.

        It is instantiated by a singleton object.

        Parameters
        ----------
        Settings: `control.helpers.generic.AttrDict`
            App-wide configuration data obtained from
            `control.config.Config.Settings`.
        &#34;&#34;&#34;
        self.Settings = Settings
        self.viewers = Settings.viewers
        self.viewerDefault = Settings.viewerDefault

    def addAuth(self, Auth):
        &#34;&#34;&#34;Give this object a handle to the Auth object.

        The Viewers and Auth objects need each other, so one of them must
        be given the handle to the other after initialization.
        &#34;&#34;&#34;
        self.Auth = Auth

    def check(self, viewer, version):
        &#34;&#34;&#34;Checks whether a viewer version exists.

        Given a viewer and a version, it is looked up whether the code
        is present.
        If not, reasonable defaults are returned instead.

        Parameters
        ----------
        viewer: string
            The viewer in question.
        version: string
            The version of the viewer in question.

        Returns
        -------
        tuple
            The viewer and version are returned unmodified if that viewer
            version is supported.
            If the viewer is supported, but not the version, the latest
            supported version of that viewer is taken.
            If the viewer is not supported, the default viewer is taken.
        &#34;&#34;&#34;
        viewers = self.viewers
        if viewer not in viewers:
            viewer = self.viewerDefault
        versions = viewers[viewer].versions
        if version not in versions:
            version = versions[-1]
        return (viewer, version)

    def getButtons(
        self, sceneId, actions, isSceneActive, viewerActive, versionActive, actionActive
    ):
        &#34;&#34;&#34;Produces a set of buttons to launch 3D viewers for a scene.

        Parameters
        ----------
        sceneId: ObjectId
            The scene in question.
        actions: iterable of string
            The actions for which we have to create buttons.
            Typically `view` and possibly also `edit`.
        isSceneActive: boolean
            Whether this scene is active, i.e. loaded in a 3D viewer.
        viewerActive: string or None
            The viewer in which the scene is currently loaded,
            if any, otherwise None
        versionActive: string or None
            The version of the viewer in which the scene is currently loaded,
            if any, otherwise None
        actionActive: string or None
            The mode in which the scene is currently loaded in the viewer
            (`view` or `edit`),
            if any, otherwise None

        Returns
        -------
        string
            The HTML that represents the buttons.
        &#34;&#34;&#34;
        viewers = self.viewers

        buttons = []
        frame = &#34;&#34;

        for viewer in viewers:
            isViewerActive = isSceneActive and viewer == viewerActive
            vwActive = &#34;active&#34; if isViewerActive else &#34;&#34;
            buttons.append(
                dedent(
                    f&#34;&#34;&#34;&lt;span class=&#34;vw&#34;&gt;&lt;span class=&#34;vwl {vwActive}&#34;&gt;{viewer}&lt;/span&gt;
                        &lt;span class=&#34;vwv&#34;&gt;
                    &#34;&#34;&#34;
                )
            )

            for version in viewers[viewer].versions:
                isVersionActive = isViewerActive and version == versionActive
                vsActive = &#34;active&#34; if isVersionActive else &#34;&#34;
                buttons.append(
                    f&#34;&#34;&#34;&lt;span class=&#34;vv&#34;&gt;&lt;span class=&#34;vvl {vsActive}&#34;&gt;{version}&lt;/span&gt;&#34;&#34;&#34;
                )
                for action in actions:
                    isActionActive = isVersionActive and action == actionActive
                    btActive = &#34;active&#34; if isActionActive else &#34;&#34;

                    elem = &#34;a&#34;
                    attStr = &#34;&#34;

                    if btActive:
                        frame = dedent(
                            f&#34;&#34;&#34;
                            &lt;div class=&#34;model&#34;&gt;
                                &lt;iframe
                                  class=&#34;previewer&#34;
                                  src=&#34;/viewer/{viewer}/{version}/{action}/{sceneId}&#34;/&gt;
                                &lt;/iframe&gt;
                            &lt;/div&gt;
                            &#34;&#34;&#34;
                        )
                        elem = &#34;span&#34;
                    else:
                        attStr = (
                            f&#39; href=&#34;/scenes/{sceneId}/{viewer}/{version}/{action}&#34; &#39;
                        )

                    cls = f&#34;button {btActive} vwb&#34;
                    begin = f&#34;&#34;&#34;&lt;{elem} class=&#34;{cls}&#34; {attStr}&gt;&#34;&#34;&#34;
                    end = f&#34;&lt;/{elem}&gt;&#34;
                    buttons.append(f&#34;{begin}{action}{end}&#34;)
                buttons.append(&#34;&#34;&#34;&lt;/span&gt; &#34;&#34;&#34;)
            buttons.append(&#34;&#34;&#34;&lt;/span&gt;&lt;/span&gt; &#34;&#34;&#34;)

        return (frame, &#34;\n&#34;.join(buttons))

    def genHtml(self, urlBase, sceneName, viewer, version, action):
        &#34;&#34;&#34;Generates the HTML for the viewer page that is loaded in an iframe.

        When a scene is loaded in a viewer, it happens in an iframe.
        Here we generate the complete HTML for such an iframe.

        Parameters
        ----------
        urlBase: string
            The first part of the root url that is given to the viewer.
            The viewer code uses this to retrieve additional information.
            The root url will be completed with the `action` and the `viewer`.
        sceneName: string
            The name of the scene in the file system. The viewer will find the
            scene json file by this name.
        viewer: string
            The chosen viewer.
        version: string
            The chosen version of the viewer.
        action: string
            The chosen mode in which the viewer is launched (`view` or `edit`).

        Returns
        -------
        string
            The HTML for the iframe.
        &#34;&#34;&#34;
        Settings = self.Settings
        debugMode = Settings.debugMode
        viewerUrlBase = Settings.viewerUrlBase

        ext = &#34;dev&#34; if debugMode else &#34;min&#34;

        viewerStatic = f&#34;{viewerUrlBase}/{viewer}/{version}&#34;
        viewerRoot = self.getRoot(urlBase, action, viewer)

        if viewer == &#34;voyager&#34;:
            element = &#34;explorer&#34; if action == &#34;view&#34; else &#34;story&#34;
            return dedent(
                f&#34;&#34;&#34;
                &lt;head&gt;
                &lt;meta charset=&#34;utf-8&#34;&gt;
                &lt;link
                  href=&#34;{viewerStatic}/fonts/fonts.css&#34;
                  rel=&#34;stylesheet&#34;
                /&gt;
                &lt;link
                  rel=&#34;shortcut icon&#34;
                  type=&#34;image/png&#34;
                  href=&#34;{viewerStatic}/favicon.png&#34;
                /&gt;
                &lt;link
                  rel=&#34;stylesheet&#34;
                  href=&#34;{viewerStatic}/css/voyager-{element}.{ext}.css&#34;
                /&gt;
                &lt;script
                  defer
                  src=&#34;{viewerStatic}/js/voyager-{element}.{ext}.js&#34;&gt;
                &lt;/script&gt;
                &lt;/head&gt;
                &lt;body&gt;
                &lt;voyager-{element}
                  root=&#34;{viewerRoot}&#34;
                  document=&#34;{sceneName}.json&#34;
                  resourceroot=&#34;{viewerStatic}&#34;
                &gt; &lt;/voyager-{element}&gt;
                &lt;/body&gt;
                &#34;&#34;&#34;
            )
        else:
            return dedent(
                f&#34;&#34;&#34;
                &lt;head&gt;
                &lt;meta charset=&#34;utf-8&#34;&gt;
                &lt;/head&gt;
                &lt;body&gt;
                &lt;p&gt;Unsupported viewer: {viewer}&lt;/p&gt;
                &lt;/body&gt;
                &#34;&#34;&#34;
            )

    def getRoot(self, urlBase, action, viewer):
        &#34;&#34;&#34;Composes the root url for a viewer.

        Parameters
        ----------
        urlBase: string
            The first part of the root url, depending
            on the project and edition.
        action: string
            The mode in which the viewer is opened.
            Depending on the mode, the viewer code may communicate with the server
            with different urls.
            For example, for the voyager,
            the `view` mode (voyager-explorer) uses ordinary HTTP requests,
            but the `edit` mode (voyager-story) uses WebDAV requests.

            So this app points voyager-explorer to a root url starting with `/data`,
            and voyager-story to a root url starting with `/webdav`.

            These prefixes of the urls can be configured per viewer
            in the viewer configuration in `yaml/viewers.yml`.
        &#34;&#34;&#34;
        viewers = self.viewers

        if viewer not in viewers:
            return None

        modes = viewers[viewer].modes

        prefix = modes[action] or modes.view

        return f&#34;{prefix}/{urlBase}&#34;</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="control.viewers.Viewers.addAuth"><code class="name flex">
<span>def <span class="ident">addAuth</span></span>(<span>self, Auth)</span>
</code></dt>
<dd>
<div class="desc"><p>Give this object a handle to the Auth object.</p>
<p>The Viewers and Auth objects need each other, so one of them must
be given the handle to the other after initialization.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CLARIAH/pure3dx/blob/5948f0757efdfdd0b019d9d5582f265e8b31e9f2/src/pure3d/control/viewers.py#L23-L29" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def addAuth(self, Auth):
    &#34;&#34;&#34;Give this object a handle to the Auth object.

    The Viewers and Auth objects need each other, so one of them must
    be given the handle to the other after initialization.
    &#34;&#34;&#34;
    self.Auth = Auth</code></pre>
</details>
</dd>
<dt id="control.viewers.Viewers.check"><code class="name flex">
<span>def <span class="ident">check</span></span>(<span>self, viewer, version)</span>
</code></dt>
<dd>
<div class="desc"><p>Checks whether a viewer version exists.</p>
<p>Given a viewer and a version, it is looked up whether the code
is present.
If not, reasonable defaults are returned instead.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>viewer</code></strong> :&ensp;<code>string</code></dt>
<dd>The viewer in question.</dd>
<dt><strong><code>version</code></strong> :&ensp;<code>string</code></dt>
<dd>The version of the viewer in question.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple</code></dt>
<dd>The viewer and version are returned unmodified if that viewer
version is supported.
If the viewer is supported, but not the version, the latest
supported version of that viewer is taken.
If the viewer is not supported, the default viewer is taken.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CLARIAH/pure3dx/blob/5948f0757efdfdd0b019d9d5582f265e8b31e9f2/src/pure3d/control/viewers.py#L31-L60" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def check(self, viewer, version):
    &#34;&#34;&#34;Checks whether a viewer version exists.

    Given a viewer and a version, it is looked up whether the code
    is present.
    If not, reasonable defaults are returned instead.

    Parameters
    ----------
    viewer: string
        The viewer in question.
    version: string
        The version of the viewer in question.

    Returns
    -------
    tuple
        The viewer and version are returned unmodified if that viewer
        version is supported.
        If the viewer is supported, but not the version, the latest
        supported version of that viewer is taken.
        If the viewer is not supported, the default viewer is taken.
    &#34;&#34;&#34;
    viewers = self.viewers
    if viewer not in viewers:
        viewer = self.viewerDefault
    versions = viewers[viewer].versions
    if version not in versions:
        version = versions[-1]
    return (viewer, version)</code></pre>
</details>
</dd>
<dt id="control.viewers.Viewers.genHtml"><code class="name flex">
<span>def <span class="ident">genHtml</span></span>(<span>self, urlBase, sceneName, viewer, version, action)</span>
</code></dt>
<dd>
<div class="desc"><p>Generates the HTML for the viewer page that is loaded in an iframe.</p>
<p>When a scene is loaded in a viewer, it happens in an iframe.
Here we generate the complete HTML for such an iframe.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>urlBase</code></strong> :&ensp;<code>string</code></dt>
<dd>The first part of the root url that is given to the viewer.
The viewer code uses this to retrieve additional information.
The root url will be completed with the <code>action</code> and the <code>viewer</code>.</dd>
<dt><strong><code>sceneName</code></strong> :&ensp;<code>string</code></dt>
<dd>The name of the scene in the file system. The viewer will find the
scene json file by this name.</dd>
<dt><strong><code>viewer</code></strong> :&ensp;<code>string</code></dt>
<dd>The chosen viewer.</dd>
<dt><strong><code>version</code></strong> :&ensp;<code>string</code></dt>
<dd>The chosen version of the viewer.</dd>
<dt><strong><code>action</code></strong> :&ensp;<code>string</code></dt>
<dd>The chosen mode in which the viewer is launched (<code>view</code> or <code>edit</code>).</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>string</code></dt>
<dd>The HTML for the iframe.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CLARIAH/pure3dx/blob/5948f0757efdfdd0b019d9d5582f265e8b31e9f2/src/pure3d/control/viewers.py#L147-L226" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def genHtml(self, urlBase, sceneName, viewer, version, action):
    &#34;&#34;&#34;Generates the HTML for the viewer page that is loaded in an iframe.

    When a scene is loaded in a viewer, it happens in an iframe.
    Here we generate the complete HTML for such an iframe.

    Parameters
    ----------
    urlBase: string
        The first part of the root url that is given to the viewer.
        The viewer code uses this to retrieve additional information.
        The root url will be completed with the `action` and the `viewer`.
    sceneName: string
        The name of the scene in the file system. The viewer will find the
        scene json file by this name.
    viewer: string
        The chosen viewer.
    version: string
        The chosen version of the viewer.
    action: string
        The chosen mode in which the viewer is launched (`view` or `edit`).

    Returns
    -------
    string
        The HTML for the iframe.
    &#34;&#34;&#34;
    Settings = self.Settings
    debugMode = Settings.debugMode
    viewerUrlBase = Settings.viewerUrlBase

    ext = &#34;dev&#34; if debugMode else &#34;min&#34;

    viewerStatic = f&#34;{viewerUrlBase}/{viewer}/{version}&#34;
    viewerRoot = self.getRoot(urlBase, action, viewer)

    if viewer == &#34;voyager&#34;:
        element = &#34;explorer&#34; if action == &#34;view&#34; else &#34;story&#34;
        return dedent(
            f&#34;&#34;&#34;
            &lt;head&gt;
            &lt;meta charset=&#34;utf-8&#34;&gt;
            &lt;link
              href=&#34;{viewerStatic}/fonts/fonts.css&#34;
              rel=&#34;stylesheet&#34;
            /&gt;
            &lt;link
              rel=&#34;shortcut icon&#34;
              type=&#34;image/png&#34;
              href=&#34;{viewerStatic}/favicon.png&#34;
            /&gt;
            &lt;link
              rel=&#34;stylesheet&#34;
              href=&#34;{viewerStatic}/css/voyager-{element}.{ext}.css&#34;
            /&gt;
            &lt;script
              defer
              src=&#34;{viewerStatic}/js/voyager-{element}.{ext}.js&#34;&gt;
            &lt;/script&gt;
            &lt;/head&gt;
            &lt;body&gt;
            &lt;voyager-{element}
              root=&#34;{viewerRoot}&#34;
              document=&#34;{sceneName}.json&#34;
              resourceroot=&#34;{viewerStatic}&#34;
            &gt; &lt;/voyager-{element}&gt;
            &lt;/body&gt;
            &#34;&#34;&#34;
        )
    else:
        return dedent(
            f&#34;&#34;&#34;
            &lt;head&gt;
            &lt;meta charset=&#34;utf-8&#34;&gt;
            &lt;/head&gt;
            &lt;body&gt;
            &lt;p&gt;Unsupported viewer: {viewer}&lt;/p&gt;
            &lt;/body&gt;
            &#34;&#34;&#34;
        )</code></pre>
</details>
</dd>
<dt id="control.viewers.Viewers.getButtons"><code class="name flex">
<span>def <span class="ident">getButtons</span></span>(<span>self, sceneId, actions, isSceneActive, viewerActive, versionActive, actionActive)</span>
</code></dt>
<dd>
<div class="desc"><p>Produces a set of buttons to launch 3D viewers for a scene.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>sceneId</code></strong> :&ensp;<code>ObjectId</code></dt>
<dd>The scene in question.</dd>
<dt><strong><code>actions</code></strong> :&ensp;<code>iterable</code> of <code>string</code></dt>
<dd>The actions for which we have to create buttons.
Typically <code>view</code> and possibly also <code>edit</code>.</dd>
<dt><strong><code>isSceneActive</code></strong> :&ensp;<code>boolean</code></dt>
<dd>Whether this scene is active, i.e. loaded in a 3D viewer.</dd>
<dt><strong><code>viewerActive</code></strong> :&ensp;<code>string</code> or <code>None</code></dt>
<dd>The viewer in which the scene is currently loaded,
if any, otherwise None</dd>
<dt><strong><code>versionActive</code></strong> :&ensp;<code>string</code> or <code>None</code></dt>
<dd>The version of the viewer in which the scene is currently loaded,
if any, otherwise None</dd>
<dt><strong><code>actionActive</code></strong> :&ensp;<code>string</code> or <code>None</code></dt>
<dd>The mode in which the scene is currently loaded in the viewer
(<code>view</code> or <code>edit</code>),
if any, otherwise None</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>string</code></dt>
<dd>The HTML that represents the buttons.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CLARIAH/pure3dx/blob/5948f0757efdfdd0b019d9d5582f265e8b31e9f2/src/pure3d/control/viewers.py#L62-L145" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def getButtons(
    self, sceneId, actions, isSceneActive, viewerActive, versionActive, actionActive
):
    &#34;&#34;&#34;Produces a set of buttons to launch 3D viewers for a scene.

    Parameters
    ----------
    sceneId: ObjectId
        The scene in question.
    actions: iterable of string
        The actions for which we have to create buttons.
        Typically `view` and possibly also `edit`.
    isSceneActive: boolean
        Whether this scene is active, i.e. loaded in a 3D viewer.
    viewerActive: string or None
        The viewer in which the scene is currently loaded,
        if any, otherwise None
    versionActive: string or None
        The version of the viewer in which the scene is currently loaded,
        if any, otherwise None
    actionActive: string or None
        The mode in which the scene is currently loaded in the viewer
        (`view` or `edit`),
        if any, otherwise None

    Returns
    -------
    string
        The HTML that represents the buttons.
    &#34;&#34;&#34;
    viewers = self.viewers

    buttons = []
    frame = &#34;&#34;

    for viewer in viewers:
        isViewerActive = isSceneActive and viewer == viewerActive
        vwActive = &#34;active&#34; if isViewerActive else &#34;&#34;
        buttons.append(
            dedent(
                f&#34;&#34;&#34;&lt;span class=&#34;vw&#34;&gt;&lt;span class=&#34;vwl {vwActive}&#34;&gt;{viewer}&lt;/span&gt;
                    &lt;span class=&#34;vwv&#34;&gt;
                &#34;&#34;&#34;
            )
        )

        for version in viewers[viewer].versions:
            isVersionActive = isViewerActive and version == versionActive
            vsActive = &#34;active&#34; if isVersionActive else &#34;&#34;
            buttons.append(
                f&#34;&#34;&#34;&lt;span class=&#34;vv&#34;&gt;&lt;span class=&#34;vvl {vsActive}&#34;&gt;{version}&lt;/span&gt;&#34;&#34;&#34;
            )
            for action in actions:
                isActionActive = isVersionActive and action == actionActive
                btActive = &#34;active&#34; if isActionActive else &#34;&#34;

                elem = &#34;a&#34;
                attStr = &#34;&#34;

                if btActive:
                    frame = dedent(
                        f&#34;&#34;&#34;
                        &lt;div class=&#34;model&#34;&gt;
                            &lt;iframe
                              class=&#34;previewer&#34;
                              src=&#34;/viewer/{viewer}/{version}/{action}/{sceneId}&#34;/&gt;
                            &lt;/iframe&gt;
                        &lt;/div&gt;
                        &#34;&#34;&#34;
                    )
                    elem = &#34;span&#34;
                else:
                    attStr = (
                        f&#39; href=&#34;/scenes/{sceneId}/{viewer}/{version}/{action}&#34; &#39;
                    )

                cls = f&#34;button {btActive} vwb&#34;
                begin = f&#34;&#34;&#34;&lt;{elem} class=&#34;{cls}&#34; {attStr}&gt;&#34;&#34;&#34;
                end = f&#34;&lt;/{elem}&gt;&#34;
                buttons.append(f&#34;{begin}{action}{end}&#34;)
            buttons.append(&#34;&#34;&#34;&lt;/span&gt; &#34;&#34;&#34;)
        buttons.append(&#34;&#34;&#34;&lt;/span&gt;&lt;/span&gt; &#34;&#34;&#34;)

    return (frame, &#34;\n&#34;.join(buttons))</code></pre>
</details>
</dd>
<dt id="control.viewers.Viewers.getRoot"><code class="name flex">
<span>def <span class="ident">getRoot</span></span>(<span>self, urlBase, action, viewer)</span>
</code></dt>
<dd>
<div class="desc"><p>Composes the root url for a viewer.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>urlBase</code></strong> :&ensp;<code>string</code></dt>
<dd>The first part of the root url, depending
on the project and edition.</dd>
<dt><strong><code>action</code></strong> :&ensp;<code>string</code></dt>
<dd>
<p>The mode in which the viewer is opened.
Depending on the mode, the viewer code may communicate with the server
with different urls.
For example, for the voyager,
the <code>view</code> mode (voyager-explorer) uses ordinary HTTP requests,
but the <code>edit</code> mode (voyager-story) uses WebDAV requests.</p>
<p>So this app points voyager-explorer to a root url starting with <code>/data</code>,
and voyager-story to a root url starting with <code>/webdav</code>.</p>
<p>These prefixes of the urls can be configured per viewer
in the viewer configuration in <code>yaml/viewers.yml</code>.</p>
</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/CLARIAH/pure3dx/blob/5948f0757efdfdd0b019d9d5582f265e8b31e9f2/src/pure3d/control/viewers.py#L228-L259" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def getRoot(self, urlBase, action, viewer):
    &#34;&#34;&#34;Composes the root url for a viewer.

    Parameters
    ----------
    urlBase: string
        The first part of the root url, depending
        on the project and edition.
    action: string
        The mode in which the viewer is opened.
        Depending on the mode, the viewer code may communicate with the server
        with different urls.
        For example, for the voyager,
        the `view` mode (voyager-explorer) uses ordinary HTTP requests,
        but the `edit` mode (voyager-story) uses WebDAV requests.

        So this app points voyager-explorer to a root url starting with `/data`,
        and voyager-story to a root url starting with `/webdav`.

        These prefixes of the urls can be configured per viewer
        in the viewer configuration in `yaml/viewers.yml`.
    &#34;&#34;&#34;
    viewers = self.viewers

    if viewer not in viewers:
        return None

    modes = viewers[viewer].modes

    prefix = modes[action] or modes.view

    return f&#34;{prefix}/{urlBase}&#34;</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<p><a href="https://github.com/CLARIAH/pure3dx" title="GitHub repo">GitHub</a></p>
<form>
<input id="lunr-search" name="q" placeholder="🔎 Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="control" href="index.html">control</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="control.viewers.Viewers" href="#control.viewers.Viewers">Viewers</a></code></h4>
<ul class="">
<li><code><a title="control.viewers.Viewers.addAuth" href="#control.viewers.Viewers.addAuth">addAuth</a></code></li>
<li><code><a title="control.viewers.Viewers.check" href="#control.viewers.Viewers.check">check</a></code></li>
<li><code><a title="control.viewers.Viewers.genHtml" href="#control.viewers.Viewers.genHtml">genHtml</a></code></li>
<li><code><a title="control.viewers.Viewers.getButtons" href="#control.viewers.Viewers.getButtons">getButtons</a></code></li>
<li><code><a title="control.viewers.Viewers.getRoot" href="#control.viewers.Viewers.getRoot">getRoot</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<a href="https://pure.knaw.nl/portal/en/persons/dirk-roorda">Dirk Roorda</a>
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>